<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BoardDAO">
	<resultMap type="kr.ac.seoil.boardWeb.board.vo.BoardVO" id="selectBoardListMap">
	<!-- vo와 db사이에 가져와야하는 값의 변수명이 다를때 맵핑이 안되므로 이를 해결하기 위해서 이와 같이 선언을 하며 property부분에는 vo의 변수를 column에는 db의 컬럼명을 기입하여 연결한다. -->
		<result property="seq" column="SEQ"/>
		<result property="title" column="TITLE"/>
		<result property="writerName" column="WRITER_NAME"/>
		<result property="content" column="CONTENT"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="cnt" column="CNT"/>
	</resultMap>
	<!-- sql문을 생성할 때 앞에 <![CDATA[ SQL문  ]]> 를 붙여주는게 좋다 이유는 xml문은 <>로 시작하고 끝나기 때문에 만약에 a>1와 같은 조건문을 기입할 시 <> 태그로 인식이되서 오류가 나기 때문이다. -->
	
	<insert id="insertBoard">
	<![CDATA[
		INSERT INTO BOARD (
		SEQ,
		 TITLE, 
		 WRITER_NAME, 
		 CONTENT
		 ) VALUES (
		 (SELECT NVL(MAX(SEQ), 0)+1 FROM BOARD)
		 , #{title}
		 , #{writerName}
		 , #{content}
		 )		
	]]>
	</insert>
	<update id="updateBoard">
	<!-- BoardDAO.updateBoard  -->
		UPDATE BOARD SET TITLE=#{title}, CONTENT=#{content} WHERE SEQ=#{seq}
	</update>
	
	<delete id="deleteBoard">
	<!-- BoardDAO.deleteBoard -->
		DELETE BOARD WHERE SEQ=#{seq}
	</delete>
	
	<select id="selectBoard" resultMap="selectBoardListMap">
	<!-- BoardDAO.selectBoard -->	
		SELECT SEQ,TITLE,WRITER_NAME,CONTENT,REG_DATE,CNT FROM BOARD WHERE SEQ=#{seq}
	</select>

	<select id="selectBoardList" resultMap="selectBoardListMap">
	<!--BoardDAO.selectBoardList-->
	<![CDATA[
		SELECT SEQ, TITLE, WRITER_NAME, CONTENT, REG_DATE, CNT FROM BOARD 
		]]>
		<if test="searchCondition!=null">
			<if test="searchCondition=='TITLE'">
				WHERE TITLE LIKE '%' || #{searchKeyword} || '%'
			</if>
			<if test="searchCondition=='CONTENT'">
				WHERE CONTENT LIKE '%' || #{searchKeyword} || '%'
			</if>
			<if test="searchCondition=='WRITER'">
				WHERE WRITER_NAME LIKE '%' || #{searchKeyword} || '%'
			</if>
		</if>
		<![CDATA[
		ORDER BY SEQ DESC
		]]>	
	</select>
	
	
</mapper>